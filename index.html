<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Há»‡ thá»‘ng quáº£n lÃ½ Comment CTV TikTok - NÃ¢ng cao</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        const CommentManager = () => {
            const [selectedCTV, setSelectedCTV] = useState(null);
            const [expandedSections, setExpandedSections] = useState({});
            // Key format: targetCtvId-videoIndex-commenterCtvId (true = Ä‘Ã£ comment, false/undefined = chÆ°a comment)
            const [completedComments, setCompletedComments] = useState({});
            const [repliedComments, setRepliedComments] = useState({}); // Key format: targetCtvId-videoIndex (true = Ä‘Ã£ reply)
            const [deletedVideos, setDeletedVideos] = useState({}); // Key format: targetCtvId-videoIndex (true = video bá»‹ xÃ³a)
            const [ctvNotes, setCtvNotes] = useState({}); // Key format: ctvId (string note)
            const [showExportModal, setShowExportModal] = useState(false);
            const [fileName, setFileName] = useState('');
            const [exportType, setExportType] = useState('single'); // 'single' or 'all'
            const [showSettingsModal, setShowSettingsModal] = useState(false);
            const [editingCTV, setEditingCTV] = useState(null);
            const [showEditModal, setShowEditModal] = useState(false);
            const [tempNicks, setTempNicks] = useState([]);
            
            // Cáº¥u hÃ¬nh há»‡ thá»‘ng
            const [systemConfig, setSystemConfig] = useState({
                commentsPerVideo: 10,
                videosPerCTV: 3,
                totalCTV: 15
            });

            // Dá»¯ liá»‡u CTV cÃ³ thá»ƒ chá»‰nh sá»­a
            const [ctvData, setCtvData] = useState([
                { id: 1, name: "Báº£o HuÃ¢n", nicks: ["Trá»ng hoÃ ng", "Baby kajima", "Hachthieuhoang"] },
                { id: 2, name: "Huy HoÃ ng", nicks: ["Truongnhuocnam", "Dangthaouyen", "Lyvantieu"] },
                { id: 3, name: "Trung KiÃªn", nicks: ["Huynh Thanh Hoang", "Cáº­u Ä‘Ã o báº£nh", "Thanh Huy"] },
                { id: 4, name: "Viá»‡t Nguyá»…n", nicks: ["Äá»©c trá»ng quáº­n 9", "Siuponaruto", "VÅ© Diá»‡p Chi", "TÃ´ Huyá»n My"] },
                { id: 5, name: "XuÃ¢n An", nicks: ["tinhuy2k2", "daicaduongqua4", "anhypp5"] },
                { id: 6, name: "Qanh", nicks: ["Thanh háº±ng", "Thua vua trÃ² chÆ¡i má»—i cÃ¡i tÃªn", "Thy an Há»“"] },
                { id: 7, name: "QA", nicks: ["Louis Nguyá»…n", "Mai sÆ¡n", "HÃ o MÃ£"] },
                { id: 8, name: "KiÃªn Sáº¿u", nicks: ["Tá»‘ng Quang Linh", "Xa lÃ  nhá»›", "BÃ¬nh thÆ°á»ng thÃ´i"] },
                { id: 9, name: "Huá»³nh Äá»©c", nicks: ["TÃ­n vÃµ", "Vinh lÃª", "Huy há»“"] },
                { id: 10, name: "Nobita", nicks: ["Sang sáº¥m sexâš¡ï¸âš¡ï¸âš¡ï¸", "HoÃ ng Long", "Tienkhoilatao"] },
                { id: 11, name: "Quá»‘c Báº£o", nicks: ["Dung lam", "Ngá»c vÅ©", "UyÃªn tráº§n"] },
                { id: 12, name: "NHV", nicks: ["BÄƒng BÄƒng", "Mai Tháº£o My", "Mie"] },
                { id: 13, name: "Luyáº¿n", nicks: ["PhÆ°Æ¡ng Tuáº¥n", "CÃ²n thá»Ÿ cÃ²n gá»¡", "Trang Nemo", "Tráº§n VÄƒn Bo"] },
                { id: 14, name: "ChÃ­ Báº£o", nicks: ["gaumap2024", "bb090702", "baobaoipuuuuu", "baobao472"] },
                { id: 15, name: "Báº£o Phan", nicks: ["trumfcc", "baobaonpcb", "vuonhoaconca97", "pduyenn610"] }
            ]);

            // Dá»¯ liá»‡u áº£nh spam
            const [imageSpamStatus, setImageSpamStatus] = useState({}); // Key: ctvId, Value: {tiktok: number, telegram: number}
            
            // Dá»¯ liá»‡u lá»—i vÃ  cáº£nh cÃ¡o (persistent)
            const [ctvPenalties, setCtvPenalties] = useState({}); // Key: ctvId, Value: {fine20k: number, halfDayPenalty: number, fullDayPenalty: number}
            const [ctvWarnings, setCtvWarnings] = useState({}); // Key: ctvId, Value: {level: 0-3, description: string}
            
            // Load data tá»« localStorage khi component mount
            useEffect(() => {
                try {
                    const savedData = localStorage.getItem('ctvCompletedComments');
                    const savedReplies = localStorage.getItem('ctvRepliedComments');
                    const savedDeleted = localStorage.getItem('ctvDeletedVideos');
                    const savedNotes = localStorage.getItem('ctvNotes');
                    const savedConfig = localStorage.getItem('systemConfig');
                    const savedCtvData = localStorage.getItem('ctvData');
                    const savedImageSpam = localStorage.getItem('imageSpamStatus');
                    const savedPenalties = localStorage.getItem('ctvPenalties');
                    const savedWarnings = localStorage.getItem('ctvWarnings');
                    
                    if (savedData) setCompletedComments(JSON.parse(savedData));
                    if (savedReplies) setRepliedComments(JSON.parse(savedReplies));
                    if (savedDeleted) setDeletedVideos(JSON.parse(savedDeleted));
                    if (savedNotes) setCtvNotes(JSON.parse(savedNotes));
                    if (savedConfig) setSystemConfig(JSON.parse(savedConfig));
                    if (savedCtvData) setCtvData(JSON.parse(savedCtvData));
                    if (savedImageSpam) setImageSpamStatus(JSON.parse(savedImageSpam));
                    if (savedPenalties) setCtvPenalties(JSON.parse(savedPenalties));
                    if (savedWarnings) setCtvWarnings(JSON.parse(savedWarnings));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ load dá»¯ liá»‡u tá»« localStorage');
                }
            }, []);

            // Save data vÃ o localStorage khi cÃ³ thay Ä‘á»•i
            useEffect(() => {
                try {
                    localStorage.setItem('ctvCompletedComments', JSON.stringify(completedComments));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ lÆ°u dá»¯ liá»‡u vÃ o localStorage');
                }
            }, [completedComments]);

            useEffect(() => {
                try {
                    localStorage.setItem('ctvRepliedComments', JSON.stringify(repliedComments));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ lÆ°u dá»¯ liá»‡u reply vÃ o localStorage');
                }
            }, [repliedComments]);

            useEffect(() => {
                try {
                    localStorage.setItem('ctvDeletedVideos', JSON.stringify(deletedVideos));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ lÆ°u dá»¯ liá»‡u video bá»‹ xÃ³a vÃ o localStorage');
                }
            }, [deletedVideos]);

            useEffect(() => {
                try {
                    localStorage.setItem('ctvNotes', JSON.stringify(ctvNotes));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ lÆ°u ghi chÃº vÃ o localStorage');
                }
            }, [ctvNotes]);

            useEffect(() => {
                try {
                    localStorage.setItem('systemConfig', JSON.stringify(systemConfig));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ lÆ°u cáº¥u hÃ¬nh há»‡ thá»‘ng vÃ o localStorage');
                }
            }, [systemConfig]);

            useEffect(() => {
                try {
                    localStorage.setItem('ctvData', JSON.stringify(ctvData));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ lÆ°u dá»¯ liá»‡u CTV vÃ o localStorage');
                }
            }, [ctvData]);

            useEffect(() => {
                try {
                    localStorage.setItem('imageSpamStatus', JSON.stringify(imageSpamStatus));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ lÆ°u tráº¡ng thÃ¡i áº£nh spam vÃ o localStorage');
                }
            }, [imageSpamStatus]);

            useEffect(() => {
                try {
                    localStorage.setItem('ctvPenalties', JSON.stringify(ctvPenalties));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ lÆ°u dá»¯ liá»‡u pháº¡t vÃ o localStorage');
                }
            }, [ctvPenalties]);

            useEffect(() => {
                try {
                    localStorage.setItem('ctvWarnings', JSON.stringify(ctvWarnings));
                } catch (error) {
                    console.log('KhÃ´ng thá»ƒ lÆ°u dá»¯ liá»‡u cáº£nh cÃ¡o vÃ o localStorage');
                }
            }, [ctvWarnings]);

            const getCommenters = (targetCtvId) => {
                // TÃ¬m vá»‹ trÃ­ thá»±c táº¿ cá»§a CTV trong máº£ng (khÃ´ng pháº£i ID)
                const targetCtvIndex = ctvData.findIndex(ctv => ctv.id === targetCtvId);
                if (targetCtvIndex === -1) return [];
                
                const targetPosition = targetCtvIndex + 1; // Position báº¯t Ä‘áº§u tá»« 1
                const commenters = [];
                
                for (let i = 0; i < systemConfig.totalCTV; i++) {
                    const currentPosition = i + 1;
                    let startPosition = currentPosition + 1;
                    let endPosition = currentPosition + systemConfig.commentsPerVideo;
                    
                    const targetPositions = [];
                    for (let j = startPosition; j <= endPosition; j++) {
                        let actualPosition = j;
                        if (j > systemConfig.totalCTV) actualPosition = j - systemConfig.totalCTV;
                        targetPositions.push(actualPosition);
                    }
                    
                    if (targetPositions.includes(targetPosition)) {
                        // Tráº£ vá» ID cá»§a CTV á»Ÿ vá»‹ trÃ­ i
                        commenters.push(ctvData[i].id);
                    }
                }
                return commenters;
            };

            const toggleSection = (section) => {
                setExpandedSections(prev => ({
                    ...prev,
                    [section]: !prev[section]
                }));
            };

            const handleCheckboxChange = (targetCtvId, videoIndex, commenterCtvId) => {
                const key = `${targetCtvId}-${videoIndex}-${commenterCtvId}`;
                setCompletedComments(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            const handleReplyCheckboxChange = (targetCtvId, videoIndex) => {
                const key = `${targetCtvId}-${videoIndex}`;
                setRepliedComments(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            const handleDeletedVideoChange = (targetCtvId, videoIndex) => {
                const key = `${targetCtvId}-${videoIndex}`;
                setDeletedVideos(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            const handleNoteChange = (ctvId, note) => {
                setCtvNotes(prev => ({
                    ...prev,
                    [ctvId]: note
                }));
            };

            const resetData = () => {
                if (confirm('Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n reset dá»¯ liá»‡u comment? Lá»—i vÃ  cáº£nh cÃ¡o sáº½ Ä‘Æ°á»£c giá»¯ láº¡i!')) {
                    setCompletedComments({});
                    setRepliedComments({});
                    setDeletedVideos({});
                    setCtvNotes({});
                    setImageSpamStatus({});
                    localStorage.removeItem('ctvCompletedComments');
                    localStorage.removeItem('ctvRepliedComments');
                    localStorage.removeItem('ctvDeletedVideos');
                    localStorage.removeItem('ctvNotes');
                    localStorage.removeItem('imageSpamStatus');
                    alert('ÄÃ£ reset dá»¯ liá»‡u comment thÃ nh cÃ´ng! Lá»—i vÃ  cáº£nh cÃ¡o Ä‘Æ°á»£c giá»¯ láº¡i.');
                }
            };

            // TÃ­nh tá»· lá»‡ hoÃ n thÃ nh cho tá»«ng video (tÃ­nh theo sá»‘ CTV Ä‘Ã£ Ä‘Ã¡nh dáº¥u hoÃ n thÃ nh)
            const getVideoCompletionRate = (targetCtvId, videoIndex) => {
                const commenters = getCommenters(targetCtvId);
                let completedCount = 0;
                
                commenters.forEach(commenterId => {
                    const key = `${targetCtvId}-${videoIndex}-${commenterId}`;
                    if (completedComments[key]) {
                        completedCount++; // ÄÃ£ tick = Ä‘Ã£ hoÃ n thÃ nh
                    }
                });
                
                return Math.round((completedCount / commenters.length) * 100);
            };

            // TÃ­nh tá»· lá»‡ hoÃ n thÃ nh tá»•ng cho CTV
            const getOverallCompletionRate = (targetCtvId) => {
                let totalRate = 0;
                for (let i = 0; i < systemConfig.videosPerCTV; i++) {
                    totalRate += getVideoCompletionRate(targetCtvId, i);
                }
                return Math.round(totalRate / systemConfig.videosPerCTV);
            };

            // TÃ­nh lÆ°Æ¡ng sau trá»« pháº¡t
            const calculateSalary = (ctvId) => {
                const baseSalary = 1100000; // 1tr1
                const penalties = ctvPenalties[ctvId] || { fine20k: 0, halfDayPenalty: 0, fullDayPenalty: 0 };
                const dailySalary = baseSalary / 30; // LÆ°Æ¡ng 1 ngÃ y
                
                const totalDeduction = 
                    (penalties.fine20k * 20000) +
                    (penalties.halfDayPenalty * dailySalary * 0.5) +
                    (penalties.fullDayPenalty * dailySalary);
                
                return baseSalary - totalDeduction;
            };

            // Cáº­p nháº­t lá»—i
            const updatePenalty = (ctvId, type, value) => {
                setCtvPenalties(prev => ({
                    ...prev,
                    [ctvId]: {
                        ...prev[ctvId],
                        [type]: Math.max(0, value)
                    }
                }));
            };

            // Cáº­p nháº­t cáº£nh cÃ¡o
            const updateWarning = (ctvId, level) => {
                const warningLevels = [
                    { level: 0, text: 'BÃ¬nh thÆ°á»ng', color: 'bg-gray-100 text-gray-800' },
                    { level: 1, text: 'Nháº¯c nhá»Ÿ', color: 'bg-blue-100 text-blue-800' },
                    { level: 2, text: 'Cáº£nh cÃ¡o', color: 'bg-yellow-100 text-yellow-800' },
                    { level: 3, text: 'Cáº£nh cÃ¡o láº§n 2', color: 'bg-orange-100 text-orange-800' },
                    { level: 4, text: 'Äuá»•i viá»‡c', color: 'bg-red-100 text-red-800' }
                ];
                
                setCtvWarnings(prev => ({
                    ...prev,
                    [ctvId]: {
                        level: level,
                        text: warningLevels[level].text,
                        color: warningLevels[level].color
                    }
                }));
            };

            // Cáº­p nháº­t áº£nh spam
            const updateImageSpam = (ctvId, type, value) => {
                setImageSpamStatus(prev => ({
                    ...prev,
                    [ctvId]: {
                        ...prev[ctvId],
                        [type]: Math.max(0, Math.min(type === 'tiktok' ? 15 : 5, value))
                    }
                }));
            };

            // Di chuyá»ƒn CTV trong danh sÃ¡ch (giá»¯ nguyÃªn vá»‹ trÃ­ sá»‘ thá»© tá»±)
            const moveCTV = (ctvId, direction) => {
                const currentIndex = ctvData.findIndex(ctv => ctv.id === ctvId);
                if (currentIndex === -1) return;
                
                const newIndex = direction === 'up' ? currentIndex - 1 : currentIndex + 1;
                if (newIndex < 0 || newIndex >= ctvData.length) return;
                
                const newCtvData = [...ctvData];
                // Chá»‰ hoÃ¡n Ä‘á»•i thÃ´ng tin CTV, giá»¯ nguyÃªn ID (vá»‹ trÃ­ sá»‘ thá»© tá»±)
                const temp = { ...newCtvData[currentIndex] };
                newCtvData[currentIndex] = { ...newCtvData[newIndex], id: newCtvData[currentIndex].id };
                newCtvData[newIndex] = { ...temp, id: newCtvData[newIndex].id };
                setCtvData(newCtvData);
            };

            // TÃ­nh khung giá» cho tá»«ng vá»‹ trÃ­ (9h Ä‘áº¿n 23h)
            const getTimeSlot = (position) => {
                const startHour = 9;
                const hour = startHour + (position - 1);
                return `${hour}:00`;
            };

            // Kiá»ƒm tra xem cÃ³ thá»ƒ bá» tick reply khÃ´ng (táº¥t cáº£ comment pháº£i Ä‘Æ°á»£c hoÃ n thÃ nh)
            const canUntickReply = (targetCtvId, videoIndex) => {
                const commenters = getCommenters(targetCtvId);
                return commenters.every(commenterId => {
                    const key = `${targetCtvId}-${videoIndex}-${commenterId}`;
                    return completedComments[key] === true;
                });
            };

            // Kiá»ƒm tra xem cÃ³ comment nÃ o Ä‘Æ°á»£c hoÃ n thÃ nh khÃ´ng
            const hasAnyCompletedComments = (targetCtvId, videoIndex) => {
                const commenters = getCommenters(targetCtvId);
                return commenters.some(commenterId => {
                    const key = `${targetCtvId}-${videoIndex}-${commenterId}`;
                    return completedComments[key] === true;
                });
            };

            // Xá»­ lÃ½ thay Ä‘á»•i reply checkbox vá»›i validation
            const handleReplyCheckboxChangeWithValidation = (targetCtvId, videoIndex) => {
                const key = `${targetCtvId}-${videoIndex}`;
                const currentReplyStatus = repliedComments[key];
                
                if (currentReplyStatus) {
                    // Äang muá»‘n bá» tick reply
                    if (!canUntickReply(targetCtvId, videoIndex)) {
                        alert('KhÃ´ng thá»ƒ bá» tick reply khi chÆ°a hoÃ n thÃ nh táº¥t cáº£ comment!');
                        return;
                    }
                } else {
                    // Äang muá»‘n tick reply
                    if (!hasAnyCompletedComments(targetCtvId, videoIndex)) {
                        alert('Cáº§n cÃ³ Ã­t nháº¥t 1 comment Ä‘Æ°á»£c hoÃ n thÃ nh trÆ°á»›c khi cÃ³ thá»ƒ reply!');
                        return;
                    }
                }
                
                setRepliedComments(prev => ({
                    ...prev,
                    [key]: !prev[key]
                }));
            };

            // Má»Ÿ modal chá»‰nh sá»­a CTV
            const openEditCTVModal = (ctv) => {
                setEditingCTV(ctv);
                setTempNicks([...ctv.nicks]);
                setShowEditModal(true);
            };

            // LÆ°u thay Ä‘á»•i CTV
            const saveEditCTV = () => {
                if (!editingCTV) return;
                
                setCtvData(prev => prev.map(ctv => 
                    ctv.id === editingCTV.id 
                        ? { ...ctv, nicks: tempNicks.filter(nick => nick.trim() !== '') }
                        : ctv
                ));
                
                setShowEditModal(false);
                setEditingCTV(null);
                setTempNicks([]);
            };

            // ThÃªm nick má»›i
            const addNewNick = () => {
                setTempNicks(prev => [...prev, '']);
            };

            // XÃ³a nick
            const removeNick = (index) => {
                setTempNicks(prev => prev.filter((_, i) => i !== index));
            };

            // Cáº­p nháº­t nick
            const updateNick = (index, value) => {
                setTempNicks(prev => prev.map((nick, i) => i === index ? value : nick));
            };

            const openExportModal = (type) => {
                setExportType(type);
                const defaultName = type === 'single' 
                    ? `CTV_${ctvData.find(c => c.id === selectedCTV)?.name}_BaoCao_${new Date().toISOString().split('T')[0]}`
                    : `TatCa_CTV_BaoCao_${new Date().toISOString().split('T')[0]}`;
                setFileName(defaultName);
                setShowExportModal(true);
            };

            const exportData = () => {
                if (!fileName.trim()) {
                    alert('Vui lÃ²ng nháº­p tÃªn file!');
                    return;
                }

                let exportData = [];
                
                if (exportType === 'single') {
                    if (!selectedCTV) {
                        alert('Vui lÃ²ng chá»n CTV trÆ°á»›c khi xuáº¥t dá»¯ liá»‡u!');
                        return;
                    }

                    const targetCtv = ctvData.find(c => c.id === selectedCTV);
                    
                    // Táº¡o dá»¯ liá»‡u xuáº¥t cho tá»«ng video
                    for (let videoIndex = 0; videoIndex < systemConfig.videosPerCTV; videoIndex++) {
                        const commenters = getCommenters(selectedCTV);
                        const missingCommenters = [];
                        
                        commenters.forEach(commenterId => {
                            const key = `${selectedCTV}-${videoIndex}-${commenterId}`;
                            if (!completedComments[key]) { // ChÆ°a tick = chÆ°a comment
                                const commenterCtv = ctvData.find(c => c.id === commenterId);
                                missingCommenters.push(commenterCtv?.name);
                            }
                        });
                        
                        let status = '';
                        const replyKey = `${selectedCTV}-${videoIndex}`;
                        const deletedKey = `${selectedCTV}-${videoIndex}`;
                        const hasReplied = repliedComments[replyKey];
                        const isDeleted = deletedVideos[deletedKey];
                        
                        if (isDeleted) {
                            status = 'Video Ä‘Ã£ bá»‹ xÃ³a';
                        } else if (missingCommenters.length === 0) {
                            status = 'CTV Ä‘Ã£ comment Ä‘á»§';
                        } else {
                            status = `thiáº¿u ${missingCommenters.length} comment cá»§a CTV ${missingCommenters.join(', ')}`;
                        }
                        
                        if (!hasReplied && !isDeleted) {
                            status += `, CTV ${targetCtv?.name} chÆ°a rep comment cá»§a má»i ngÆ°á»i`;
                        }
                        
                        exportData.push({
                            [`CTV ${targetCtv?.name}`]: `Video sá»‘ ${videoIndex + 1}, ${status}`
                        });
                    }
                } else {
                    // Xuáº¥t táº¥t cáº£ CTV
                    ctvData.forEach(ctv => {
                        for (let videoIndex = 0; videoIndex < systemConfig.videosPerCTV; videoIndex++) {
                            const commenters = getCommenters(ctv.id);
                            const missingCommenters = [];
                            
                            commenters.forEach(commenterId => {
                                const key = `${ctv.id}-${videoIndex}-${commenterId}`;
                                if (!completedComments[key]) { // ChÆ°a tick = chÆ°a comment
                                    const commenterCtv = ctvData.find(c => c.id === commenterId);
                                    missingCommenters.push(commenterCtv?.name);
                                }
                            });
                            
                            let status = '';
                            const replyKey = `${ctv.id}-${videoIndex}`;
                            const deletedKey = `${ctv.id}-${videoIndex}`;
                            const hasReplied = repliedComments[replyKey];
                            const isDeleted = deletedVideos[deletedKey];
                            
                            if (isDeleted) {
                                status = 'Video Ä‘Ã£ bá»‹ xÃ³a';
                            } else if (missingCommenters.length === 0) {
                                status = 'CTV Ä‘Ã£ comment Ä‘á»§';
                            } else {
                                status = `thiáº¿u ${missingCommenters.length} comment cá»§a CTV ${missingCommenters.join(', ')}`;
                            }
                            
                            if (!hasReplied && !isDeleted) {
                                status += `, CTV ${ctv.name} chÆ°a rep comment cá»§a má»i ngÆ°á»i`;
                            }
                            
                            exportData.push({
                                [`CTV ${ctv.name}`]: `Video sá»‘ ${videoIndex + 1}, ${status}`
                            });
                        }
                    });
                }

                // Táº¡o CSV content
                const csvContent = exportData.map(row => 
                    Object.values(row).map(val => `"${(val || '').toString().replace(/"/g, '""')}"`).join(',')
                ).join('\n');
                
                const headers = Object.keys(exportData[0] || {}).map(h => `"${h}"`).join(',');
                const fullCsvContent = headers + '\n' + csvContent;

                // Táº¡o file download
                const blob = new Blob(['\ufeff' + fullCsvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `${fileName}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                setShowExportModal(false);
                
                // Náº¿u xuáº¥t file tá»•ng, reset dá»¯ liá»‡u
                if (exportType === 'all') {
                    if (confirm('Xuáº¥t file thÃ nh cÃ´ng! Báº¡n cÃ³ muá»‘n reset dá»¯ liá»‡u comment khÃ´ng? (Lá»—i vÃ  cáº£nh cÃ¡o sáº½ Ä‘Æ°á»£c giá»¯ láº¡i)')) {
                        setCompletedComments({});
                        setRepliedComments({});
                        setDeletedVideos({});
                        setCtvNotes({});
                        setImageSpamStatus({});
                        localStorage.removeItem('ctvCompletedComments');
                        localStorage.removeItem('ctvRepliedComments');
                        localStorage.removeItem('ctvDeletedVideos');
                        localStorage.removeItem('ctvNotes');
                        localStorage.removeItem('imageSpamStatus');
                        alert('ÄÃ£ reset dá»¯ liá»‡u comment thÃ nh cÃ´ng! Lá»—i vÃ  cáº£nh cÃ¡o Ä‘Æ°á»£c giá»¯ láº¡i.');
                    }
                }
            };

            const totalCommentsPerVideo = systemConfig.commentsPerVideo;
            const totalCommentsPerCTV = totalCommentsPerVideo * systemConfig.videosPerCTV;

            return React.createElement('div', { className: "max-w-7xl mx-auto p-3 sm:p-6 bg-gray-50 min-h-screen" },
                React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-3 sm:p-6 mb-4 sm:mb-6" },
                    React.createElement('h1', { className: "text-lg sm:text-2xl font-bold text-gray-800 mb-4 flex items-center" },
                        React.createElement('span', { className: "mr-2" }, 'ðŸ’¬'),
                        'Há»‡ thá»‘ng quáº£n lÃ½ CTV TikTok - NÃ¢ng cao'
                    ),
                    
                    React.createElement('div', { className: "grid grid-cols-2 md:grid-cols-5 gap-2 sm:gap-4 mb-4 sm:mb-6" },
                        React.createElement('div', { className: "bg-blue-50 p-3 sm:p-4 rounded-lg" },
                            React.createElement('div', { className: "flex items-center text-blue-600 mb-2" },
                                React.createElement('span', { className: "mr-2" }, 'ðŸ‘¥'),
                                React.createElement('span', { className: "font-semibold text-xs sm:text-sm" }, 'Tá»•ng CTV')
                            ),
                            React.createElement('div', { className: "text-xl sm:text-2xl font-bold text-blue-800" }, systemConfig.totalCTV)
                        ),
                        
                        React.createElement('div', { className: "bg-green-50 p-3 sm:p-4 rounded-lg" },
                            React.createElement('div', { className: "flex items-center text-green-600 mb-2" },
                                React.createElement('span', { className: "mr-2" }, 'ðŸ“¹'),
                                React.createElement('span', { className: "font-semibold text-xs sm:text-sm" }, 'Cmt/Video')
                            ),
                            React.createElement('div', { className: "text-xl sm:text-2xl font-bold text-green-800" }, systemConfig.commentsPerVideo)
                        ),
                        
                        React.createElement('div', { className: "bg-purple-50 p-3 sm:p-4 rounded-lg" },
                            React.createElement('div', { className: "flex items-center text-purple-600 mb-2" },
                                React.createElement('span', { className: "mr-2" }, 'ðŸ’¬'),
                                React.createElement('span', { className: "font-semibold text-xs sm:text-sm" }, 'Video/CTV')
                            ),
                            React.createElement('div', { className: "text-xl sm:text-2xl font-bold text-purple-800" }, systemConfig.videosPerCTV)
                        ),
                        
                        React.createElement('div', { className: "bg-orange-50 p-3 sm:p-4 rounded-lg" },
                            React.createElement('button', {
                                onClick: () => setShowSettingsModal(true),
                                className: "w-full bg-orange-600 hover:bg-orange-700 text-white px-3 py-2 rounded-lg text-xs font-medium flex items-center justify-center space-x-1 transition-colors"
                            },
                                React.createElement('span', null, 'âš™ï¸'),
                                React.createElement('span', null, 'CÃ i Ä‘áº·t')
                            )
                        ),
                        
                        React.createElement('div', { className: "bg-red-50 p-3 sm:p-4 rounded-lg" },
                            React.createElement('button', {
                                onClick: resetData,
                                className: "w-full bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg text-xs font-medium flex items-center justify-center space-x-1 transition-colors"
                            },
                                React.createElement('span', null, 'ðŸ”„'),
                                React.createElement('span', null, 'Reset')
                            )
                        )
                    ),

                    React.createElement('div', { className: "flex flex-col sm:flex-row gap-2 sm:gap-4 mb-4" },
                        React.createElement('button', {
                            onClick: () => openExportModal('all'),
                            className: "flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center justify-center space-x-2 transition-colors"
                        },
                            React.createElement('span', null, 'ðŸ“Š'),
                            React.createElement('span', null, `Xuáº¥t File Tá»•ng (${systemConfig.totalCTV} CTV)`)
                        ),
                        selectedCTV && React.createElement('button', {
                            onClick: () => openExportModal('single'),
                            className: "flex-1 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center justify-center space-x-2 transition-colors"
                        },
                            React.createElement('span', null, 'ðŸ“„'),
                            React.createElement('span', null, `Xuáº¥t ${ctvData.find(c => c.id === selectedCTV)?.name}`)
                        )
                    )
                ),

                // Modal cÃ i Ä‘áº·t há»‡ thá»‘ng
                showSettingsModal && React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                    React.createElement('div', { className: "bg-white rounded-lg p-4 sm:p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto" },
                        React.createElement('h3', { className: "text-lg font-bold text-gray-800 mb-4" }, 'CÃ i Ä‘áº·t há»‡ thá»‘ng'),
                        
                        React.createElement('div', { className: "space-y-4" },
                            React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-3 gap-4" },
                                React.createElement('div', null,
                                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, 'Sá»‘ CTV:'),
                                    React.createElement('input', {
                                        type: 'number',
                                        value: systemConfig.totalCTV,
                                        onChange: (e) => setSystemConfig(prev => ({...prev, totalCTV: parseInt(e.target.value) || 15})),
                                        className: "w-full p-2 border border-gray-300 rounded-lg",
                                        min: 1,
                                        max: 50
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, 'Comment/Video:'),
                                    React.createElement('input', {
                                        type: 'number',
                                        value: systemConfig.commentsPerVideo,
                                        onChange: (e) => setSystemConfig(prev => ({...prev, commentsPerVideo: parseInt(e.target.value) || 10})),
                                        className: "w-full p-2 border border-gray-300 rounded-lg",
                                        min: 1,
                                        max: 20
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, 'Video/CTV:'),
                                    React.createElement('input', {
                                        type: 'number',
                                        value: systemConfig.videosPerCTV,
                                        onChange: (e) => setSystemConfig(prev => ({...prev, videosPerCTV: parseInt(e.target.value) || 3})),
                                        className: "w-full p-2 border border-gray-300 rounded-lg",
                                        min: 1,
                                        max: 10
                                    })
                                )
                            )
                        ),
                        
                        React.createElement('div', { className: "flex gap-3 mt-6" },
                            React.createElement('button', {
                                onClick: () => setShowSettingsModal(false),
                                className: "flex-1 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
                            }, 'ÄÃ³ng'),
                            React.createElement('button', {
                                onClick: () => {
                                    setShowSettingsModal(false);
                                    alert('ÄÃ£ lÆ°u cÃ i Ä‘áº·t thÃ nh cÃ´ng!');
                                },
                                className: "flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
                            }, 'LÆ°u')
                        )
                    )
                ),

                // Modal xuáº¥t file
                showExportModal && React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" },
                    React.createElement('div', { className: "bg-white rounded-lg p-4 sm:p-6 w-full max-w-md" },
                        React.createElement('h3', { className: "text-lg font-bold text-gray-800 mb-4" },
                            exportType === 'single' ? 'Xuáº¥t file CTV Ä‘Æ¡n láº»' : `Xuáº¥t file tá»•ng ${systemConfig.totalCTV} CTV`
                        ),
                        
                        React.createElement('div', { className: "mb-4" },
                            React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" },
                                'TÃªn file:'
                            ),
                            React.createElement('input', {
                                type: 'text',
                                value: fileName,
                                onChange: (e) => setFileName(e.target.value),
                                className: "w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",
                                placeholder: 'Nháº­p tÃªn file...'
                            })
                        ),
                        
                        exportType === 'all' && React.createElement('div', { className: "mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg" },
                            React.createElement('p', { className: "text-sm text-yellow-800" },
                                'âš ï¸ Sau khi xuáº¥t file tá»•ng, há»‡ thá»‘ng sáº½ há»i báº¡n cÃ³ muá»‘n reset dá»¯ liá»‡u comment khÃ´ng. Lá»—i vÃ  cáº£nh cÃ¡o sáº½ Ä‘Æ°á»£c giá»¯ láº¡i.'
                            )
                        ),
                        
                        React.createElement('div', { className: "flex flex-col sm:flex-row gap-2 sm:gap-3" },
                            React.createElement('button', {
                                onClick: () => setShowExportModal(false),
                                className: "flex-1 bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
                            }, 'Há»§y'),
                            React.createElement('button', {
                                onClick: exportData,
                                className: "flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors"
                            }, 'Xuáº¥t File')
                        )
                    )
                ),

                React.createElement('div', { className: "grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-6" },
                    // Danh sÃ¡ch CTV
                    React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-3 sm:p-6" },
                        React.createElement('div', { 
                            className: "flex items-center justify-between cursor-pointer mb-4",
                            onClick: () => toggleSection('ctvList')
                        },
                            React.createElement('h2', { className: "text-lg sm:text-xl font-semibold text-gray-800" }, 'Danh sÃ¡ch CTV'),
                            React.createElement('span', { className: "text-lg sm:text-xl" }, expandedSections.ctvList ? 'â–¼' : 'â–¶')
                        ),
                        
                        (expandedSections.ctvList !== false) && React.createElement('div', { className: "space-y-3" },
                            ctvData.map((ctv, index) => {
                                const completionPercentage = getOverallCompletionRate(ctv.id);
                                const warning = ctvWarnings[ctv.id] || { level: 0, text: 'BÃ¬nh thÆ°á»ng', color: 'bg-gray-100 text-gray-800' };
                                const penalties = ctvPenalties[ctv.id] || { fine20k: 0, halfDayPenalty: 0, fullDayPenalty: 0 };
                                const imageSpam = imageSpamStatus[ctv.id] || { tiktok: 0, telegram: 0 };
                                const salary = calculateSalary(ctv.id);
                                
                                return React.createElement('div', {
                                    key: ctv.id,
                                    className: `p-3 rounded-lg border transition-all ${
                                        selectedCTV === ctv.id 
                                            ? 'bg-blue-100 border-2 border-blue-300' 
                                            : 'bg-gray-50 hover:bg-gray-100 border-gray-200'
                                    }`,
                                },
                                    React.createElement('div', { className: "flex items-center justify-between mb-2" },
                                        React.createElement('div', { className: "flex items-center space-x-2" },
                                            React.createElement('div', { className: "flex flex-col space-y-1" },
                                                index > 0 && React.createElement('button', {
                                                    onClick: () => moveCTV(ctv.id, 'up'),
                                                    className: "text-blue-500 hover:text-blue-700 text-xs"
                                                }, 'â–²'),
                                                index < ctvData.length - 1 && React.createElement('button', {
                                                    onClick: () => moveCTV(ctv.id, 'down'),
                                                    className: "text-blue-500 hover:text-blue-700 text-xs"
                                                }, 'â–¼')
                                            ),
                                            React.createElement('div', {
                                                className: "cursor-pointer",
                                                onClick: () => setSelectedCTV(selectedCTV === ctv.id ? null : ctv.id)
                                            },
                                                React.createElement('span', { className: "font-medium text-gray-800 text-sm sm:text-base" },
                                                    `${ctv.id}. ${ctv.name}`
                                                ),
                                                React.createElement('span', { className: "text-xs sm:text-sm text-gray-500 ml-2" },
                                                    `(${ctv.nicks.length} nick${ctv.nicks.length > 1 ? 's' : ''})`
                                                )
                                            )
                                        ),
                                        React.createElement('div', { className: "flex items-center space-x-1" },
                                            React.createElement('span', { 
                                                className: `text-xs px-2 py-1 rounded ${
                                                    completionPercentage === 100 ? 'bg-green-100 text-green-800' :
                                                    completionPercentage > 0 ? 'bg-yellow-100 text-yellow-800' :
                                                    'bg-red-100 text-red-800'
                                                }`
                                            }, `${completionPercentage}%`),
                                            React.createElement('span', { className: `text-xs px-1 py-1 rounded ${warning.color}` },
                                                warning.text
                                            )
                                        )
                                    ),
                                    
                                    // ThÃ´ng tin lÆ°Æ¡ng vÃ  áº£nh spam
                                    React.createElement('div', { className: "grid grid-cols-2 gap-2 mb-2 text-xs" },
                                        React.createElement('div', { className: "bg-green-50 p-2 rounded" },
                                            React.createElement('div', { className: "font-medium text-green-800" }, 'LÆ°Æ¡ng thÃ¡ng:'),
                                            React.createElement('div', { className: "text-green-700" }, `${salary.toLocaleString('vi-VN')}Ä‘`)
                                        ),
                                        React.createElement('div', { className: "bg-blue-50 p-2 rounded" },
                                            React.createElement('div', { className: "font-medium text-blue-800" }, 'áº¢nh spam:'),
                                            React.createElement('div', { className: "text-blue-700" }, 
                                                `TT: ${imageSpam.tiktok}/15, TG: ${imageSpam.telegram}/5`
                                            )
                                        )
                                    ),
                                    
                                    selectedCTV === ctv.id && React.createElement('div', { className: "mt-3 pt-3 border-t border-gray-200 space-y-3" },
                                        // CÃ i Ä‘áº·t cáº£nh cÃ¡o
                                        React.createElement('div', { className: "bg-yellow-50 p-3 rounded-lg" },
                                            React.createElement('div', { className: "font-medium text-yellow-800 mb-2" }, 'âš ï¸ Cáº£nh cÃ¡o:'),
                                            React.createElement('div', { className: "flex flex-wrap gap-1" },
                                                ['BÃ¬nh thÆ°á»ng', 'Nháº¯c nhá»Ÿ', 'Cáº£nh cÃ¡o', 'Cáº£nh cÃ¡o láº§n 2', 'Äuá»•i viá»‡c'].map((level, idx) =>
                                                    React.createElement('button', {
                                                        key: idx,
                                                        onClick: () => updateWarning(ctv.id, idx),
                                                        className: `text-xs px-2 py-1 rounded border ${
                                                            warning.level === idx ? 'bg-yellow-200 border-yellow-400' : 'bg-white border-gray-300 hover:bg-gray-50'
                                                        }`
                                                    }, level)
                                                )
                                            )
                                        ),
                                        
                                        // CÃ i Ä‘áº·t lá»—i
                                        React.createElement('div', { className: "bg-red-50 p-3 rounded-lg" },
                                            React.createElement('div', { className: "font-medium text-red-800 mb-2" }, 'ðŸ’° Lá»—i vÃ  pháº¡t:'),
                                            React.createElement('div', { className: "space-y-2" },
                                                React.createElement('div', { className: "flex items-center justify-between" },
                                                    React.createElement('span', { className: "text-sm" }, 'Pháº¡t 20k:'),
                                                    React.createElement('div', { className: "flex items-center space-x-1" },
                                                        React.createElement('button', {
                                                            onClick: () => updatePenalty(ctv.id, 'fine20k', penalties.fine20k - 1),
                                                            className: "bg-red-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '-'),
                                                        React.createElement('span', { className: "w-8 text-center text-sm" }, penalties.fine20k),
                                                        React.createElement('button', {
                                                            onClick: () => updatePenalty(ctv.id, 'fine20k', penalties.fine20k + 1),
                                                            className: "bg-red-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '+')
                                                    )
                                                ),
                                                React.createElement('div', { className: "flex items-center justify-between" },
                                                    React.createElement('span', { className: "text-sm" }, 'Pháº¡t ná»­a ngÃ y:'),
                                                    React.createElement('div', { className: "flex items-center space-x-1" },
                                                        React.createElement('button', {
                                                            onClick: () => updatePenalty(ctv.id, 'halfDayPenalty', penalties.halfDayPenalty - 1),
                                                            className: "bg-red-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '-'),
                                                        React.createElement('span', { className: "w-8 text-center text-sm" }, penalties.halfDayPenalty),
                                                        React.createElement('button', {
                                                            onClick: () => updatePenalty(ctv.id, 'halfDayPenalty', penalties.halfDayPenalty + 1),
                                                            className: "bg-red-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '+')
                                                    )
                                                ),
                                                React.createElement('div', { className: "flex items-center justify-between" },
                                                    React.createElement('span', { className: "text-sm" }, 'Pháº¡t 1 ngÃ y:'),
                                                    React.createElement('div', { className: "flex items-center space-x-1" },
                                                        React.createElement('button', {
                                                            onClick: () => updatePenalty(ctv.id, 'fullDayPenalty', penalties.fullDayPenalty - 1),
                                                            className: "bg-red-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '-'),
                                                        React.createElement('span', { className: "w-8 text-center text-sm" }, penalties.fullDayPenalty),
                                                        React.createElement('button', {
                                                            onClick: () => updatePenalty(ctv.id, 'fullDayPenalty', penalties.fullDayPenalty + 1),
                                                            className: "bg-red-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '+')
                                                    )
                                                )
                                            )
                                        ),
                                        
                                        // CÃ i Ä‘áº·t áº£nh spam
                                        React.createElement('div', { className: "bg-purple-50 p-3 rounded-lg" },
                                            React.createElement('div', { className: "font-medium text-purple-800 mb-2" }, 'ðŸ“¸ áº¢nh spam:'),
                                            React.createElement('div', { className: "space-y-2" },
                                                React.createElement('div', { className: "flex items-center justify-between" },
                                                    React.createElement('span', { className: "text-sm" }, 'TikTok (0-15):'),
                                                    React.createElement('div', { className: "flex items-center space-x-1" },
                                                        React.createElement('button', {
                                                            onClick: () => updateImageSpam(ctv.id, 'tiktok', imageSpam.tiktok - 1),
                                                            className: "bg-purple-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '-'),
                                                        React.createElement('span', { className: "w-8 text-center text-sm" }, imageSpam.tiktok),
                                                        React.createElement('button', {
                                                            onClick: () => updateImageSpam(ctv.id, 'tiktok', imageSpam.tiktok + 1),
                                                            className: "bg-purple-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '+')
                                                    )
                                                ),
                                                React.createElement('div', { className: "flex items-center justify-between" },
                                                    React.createElement('span', { className: "text-sm" }, 'Telegram (0-5):'),
                                                    React.createElement('div', { className: "flex items-center space-x-1" },
                                                        React.createElement('button', {
                                                            onClick: () => updateImageSpam(ctv.id, 'telegram', imageSpam.telegram - 1),
                                                            className: "bg-purple-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '-'),
                                                        React.createElement('span', { className: "w-8 text-center text-sm" }, imageSpam.telegram),
                                                        React.createElement('button', {
                                                            onClick: () => updateImageSpam(ctv.id, 'telegram', imageSpam.telegram + 1),
                                                            className: "bg-purple-500 text-white px-2 py-1 rounded text-xs"
                                                        }, '+')
                                                    )
                                                )
                                            )
                                        ),
                                        
                                        // Danh sÃ¡ch video
                                        React.createElement('div', { className: "bg-green-50 p-3 rounded-lg" },
                                            React.createElement('div', { className: "text-sm text-green-800 mb-2 font-medium" }, 'ðŸ“¹ Danh sÃ¡ch video:'),
                                            React.createElement('div', { className: "space-y-1" },
                                                ctv.nicks.slice(0, systemConfig.videosPerCTV).map((nick, index) => {
                                                    const videoRate = getVideoCompletionRate(ctv.id, index);
                                                    const isDeleted = deletedVideos[`${ctv.id}-${index}`];
                                                    return React.createElement('div', {
                                                        key: index,
                                                        className: `flex items-center justify-between flex-wrap gap-1 ${isDeleted ? 'opacity-50' : ''}`
                                                    },
                                                        React.createElement('span', { 
                                                            className: `text-xs px-2 py-1 rounded flex-1 min-w-0 ${
                                                                isDeleted ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'
                                                            }`
                                                        }, `Video ${index + 1}: ${nick} ${isDeleted ? '(ÄÃ£ xÃ³a)' : ''}`),
                                                        !isDeleted && React.createElement('span', { 
                                                            className: `text-xs px-2 py-1 rounded ${
                                                                videoRate === 100 ? 'bg-green-100 text-green-800' :
                                                                videoRate > 0 ? 'bg-yellow-100 text-yellow-800' :
                                                                'bg-red-100 text-red-800'
                                                            }`
                                                        }, `${videoRate}%`)
                                                    );
                                                })
                                            ),
                                            ctv.nicks.length > systemConfig.videosPerCTV && React.createElement('div', { className: "mt-1" },
                                                React.createElement('span', { className: "text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded" },
                                                    `Nick dá»± phÃ²ng: ${ctv.nicks.slice(systemConfig.videosPerCTV).join(', ')}`
                                                )
                                            )
                                        )
                                    )
                                );
                            })
                        )
                    ),

                    // Chi tiáº¿t CTV Ä‘Æ°á»£c chá»n
                    selectedCTV ? React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-3 sm:p-6" },
                        React.createElement('h2', { className: "text-lg sm:text-xl font-semibold text-gray-800 mb-4" },
                            `Chi tiáº¿t: ${ctvData.find(c => c.id === selectedCTV)?.name}`
                        ),
                        
                        React.createElement('div', { className: "space-y-4 sm:space-y-6" },
                            // Hiá»ƒn thá»‹ tá»«ng video vÃ  ai sáº½ comment
                            ctvData.find(c => c.id === selectedCTV)?.nicks.slice(0, systemConfig.videosPerCTV).map((videoNick, videoIndex) => {
                                const commenters = getCommenters(selectedCTV);
                                const videoCompletionRate = getVideoCompletionRate(selectedCTV, videoIndex);
                                const isVideoDeleted = deletedVideos[`${selectedCTV}-${videoIndex}`];
                                const hasReplied = repliedComments[`${selectedCTV}-${videoIndex}`];
                                
                                return React.createElement('div', {
                                    key: videoIndex,
                                    className: `p-3 sm:p-4 rounded-lg ${isVideoDeleted ? 'bg-red-50 border border-red-200' : 'bg-blue-50'}`
                                },
                                    React.createElement('div', { className: "flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2" },
                                        React.createElement('h3', { className: `font-medium text-sm sm:text-base ${isVideoDeleted ? 'text-red-800' : 'text-blue-800'}` },
                                            `ðŸ“¹ Video sá»‘ ${videoIndex + 1}: ${videoNick} ${isVideoDeleted ? '(ÄÃ£ xÃ³a)' : ''}`
                                        ),
                                        !isVideoDeleted && React.createElement('div', { className: "flex items-center space-x-2" },
                                            React.createElement('span', { 
                                                className: `text-sm px-3 py-1 rounded font-medium ${
                                                    videoCompletionRate === 100 ? 'bg-green-100 text-green-800' :
                                                    videoCompletionRate > 0 ? 'bg-yellow-100 text-yellow-800' :
                                                    'bg-red-100 text-red-800'
                                                }`
                                            }, `${videoCompletionRate}%`),
                                            React.createElement('span', { className: "text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded" },
                                                `${Math.round((videoCompletionRate / 100) * systemConfig.commentsPerVideo)}/${systemConfig.commentsPerVideo} hoÃ n thÃ nh`
                                            )
                                        )
                                    ),

                                    // Checkbox video bá»‹ xÃ³a
                                    React.createElement('div', { className: "bg-red-50 p-3 rounded-lg mb-4 border border-red-200" },
                                        React.createElement('div', { className: "flex items-center space-x-3" },
                                            React.createElement('input', {
                                                type: 'checkbox',
                                                id: `deleted-${selectedCTV}-${videoIndex}`,
                                                checked: isVideoDeleted || false,
                                                onChange: () => handleDeletedVideoChange(selectedCTV, videoIndex),
                                                className: "w-4 h-4 text-red-600 bg-gray-100 border-gray-300 rounded focus:ring-red-500 focus:ring-2"
                                            }),
                                            React.createElement('label', {
                                                htmlFor: `deleted-${selectedCTV}-${videoIndex}`,
                                                className: `font-medium cursor-pointer text-sm ${
                                                    isVideoDeleted ? 'text-red-700' : 'text-gray-700'
                                                }`
                                            }, `âŒ Video bá»‹ xÃ³a`),
                                            React.createElement('span', { 
                                                className: `text-xs px-2 py-1 rounded ${
                                                    isVideoDeleted ? 'bg-red-100 text-red-800' : 'bg-gray-100 text-gray-800'
                                                }`
                                            }, isVideoDeleted ? 'ÄÃ£ xÃ³a' : 'CÃ²n video')
                                        )
                                    ),

                                    // Checkbox reply cho chá»§ video (chá»‰ hiá»‡n khi video chÆ°a bá»‹ xÃ³a)
                                    !isVideoDeleted && React.createElement('div', { className: "bg-yellow-50 p-3 rounded-lg mb-4 border border-yellow-200" },
                                        React.createElement('div', { className: "flex items-center space-x-3" },
                                            React.createElement('input', {
                                                type: 'checkbox',
                                                id: `reply-${selectedCTV}-${videoIndex}`,
                                                checked: hasReplied || false,
                                                onChange: () => handleReplyCheckboxChange(selectedCTV, videoIndex),
                                                className: "w-4 h-4 text-yellow-600 bg-gray-100 border-gray-300 rounded focus:ring-yellow-500 focus:ring-2"
                                            }),
                                            React.createElement('label', {
                                                htmlFor: `reply-${selectedCTV}-${videoIndex}`,
                                                className: `font-medium cursor-pointer text-sm ${
                                                    hasReplied ? 'text-green-700' : 'text-yellow-700'
                                                }`
                                            }, `ðŸ”„ CTV ${ctvData.find(c => c.id === selectedCTV)?.name} Ä‘Ã£ rep láº¡i comment cá»§a má»i ngÆ°á»i`),
                                            React.createElement('span', { 
                                                className: `text-xs px-2 py-1 rounded ${
                                                    hasReplied ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
                                                }`
                                            }, hasReplied ? 'ÄÃ£ rep' : 'ChÆ°a rep')
                                        )
                                    ),
                                    
                                    !isVideoDeleted && React.createElement('div', { className: "text-sm text-blue-700 mb-3" },
                                        'Danh sÃ¡ch CTV sáº½ comment vÃ o video nÃ y:'
                                    ),
                                    
                                    // Danh sÃ¡ch commenters (chá»‰ hiá»‡n khi video chÆ°a bá»‹ xÃ³a)
                                    !isVideoDeleted && React.createElement('div', { className: "space-y-2 sm:space-y-3" },
                                        commenters.map(commenterId => {
                                            const commenterCtv = ctvData.find(c => c.id === commenterId);
                                            const key = `${selectedCTV}-${videoIndex}-${commenterId}`;
                                            const isCompleted = completedComments[key] || false;
                                            
                                            return React.createElement('div', {
                                                key: commenterId,
                                                className: `bg-white p-2 sm:p-3 rounded border ${isCompleted ? 'bg-green-50 border-green-200' : 'border-gray-200'}`
                                            },
                                                React.createElement('div', { className: "flex items-center justify-between mb-2" },
                                                    React.createElement('div', { className: "flex items-center space-x-3" },
                                                        React.createElement('input', {
                                                            type: 'checkbox',
                                                            id: `checkbox-${key}`,
                                                            checked: isCompleted,
                                                            onChange: () => handleCheckboxChange(selectedCTV, videoIndex, commenterId),
                                                            className: "w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2"
                                                        }),
                                                        React.createElement('label', {
                                                            htmlFor: `checkbox-${key}`,
                                                            className: `font-medium cursor-pointer text-sm sm:text-base ${isCompleted ? 'text-green-700' : 'text-gray-800'}`
                                                        }, `${commenterId}. ${commenterCtv?.name}`)
                                                    ),
                                                    React.createElement('span', { 
                                                        className: `text-xs px-2 py-1 rounded ${
                                                            isCompleted ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
                                                        }`
                                                    }, isCompleted ? 'ÄÃ£ comment' : 'ChÆ°a comment')
                                                ),
                                                
                                                React.createElement('div', { className: "text-xs text-gray-600" },
                                                    'Sá»­ dá»¥ng nick: ',
                                                    React.createElement('span', { className: "font-mono" },
                                                        commenterCtv?.nicks.join(', ')
                                                    )
                                                )
                                            );
                                        })
                                    ),
                                    
                                    !isVideoDeleted && React.createElement('div', { className: "mt-3 pt-3 border-t border-blue-200 text-xs text-blue-600" },
                                        React.createElement('div', null, `â€¢ Tá»•ng: ${commenters.length} CTV sáº½ comment vÃ o video nÃ y`),
                                        React.createElement('div', null, `â€¢ ÄÃ£ hoÃ n thÃ nh: ${Math.round((videoCompletionRate / 100) * systemConfig.commentsPerVideo)} comment`),
                                        React.createElement('div', null, `â€¢ CÃ²n thiáº¿u: ${systemConfig.commentsPerVideo - Math.round((videoCompletionRate / 100) * systemConfig.commentsPerVideo)} comment`)
                                    ),

                                    // Hiá»ƒn thá»‹ thÃ´ng bÃ¡o khi video bá»‹ xÃ³a
                                    isVideoDeleted && React.createElement('div', { className: "text-center p-4 text-red-600 font-medium" },
                                        'âš ï¸ Video nÃ y Ä‘Ã£ bá»‹ xÃ³a. KhÃ´ng cáº§n theo dÃµi comment.'
                                    )
                                );
                            })
                        )
                    ) :
                    // Tá»•ng quan há»‡ thá»‘ng
                    React.createElement('div', { className: "bg-white rounded-lg shadow-lg p-3 sm:p-6" },
                        React.createElement('h2', { className: "text-lg sm:text-xl font-semibold text-gray-800 mb-4" },
                            'ðŸ“ˆ Tá»•ng quan há»‡ thá»‘ng'
                        ),
                        
                        React.createElement('div', { className: "space-y-4" },
                            React.createElement('div', { className: "bg-gray-50 p-3 sm:p-4 rounded-lg" },
                                React.createElement('h3', { className: "font-medium text-gray-800 mb-2 text-sm sm:text-base" }, 'Quy táº¯c comment:'),
                                React.createElement('ul', { className: "text-xs sm:text-sm text-gray-600 space-y-1" },
                                    React.createElement('li', null, `â€¢ CTV thá»© N comment cho ${systemConfig.commentsPerVideo} CTV tiáº¿p theo (N+1 Ä‘áº¿n N+${systemConfig.commentsPerVideo})`),
                                    React.createElement('li', null, `â€¢ Má»—i CTV cÃ³ ${systemConfig.videosPerCTV} video (tÆ°Æ¡ng á»©ng ${systemConfig.videosPerCTV} nick Ä‘áº§u)`),
                                    React.createElement('li', null, `â€¢ Má»—i video sáº½ nháº­n Ä‘Æ°á»£c ${systemConfig.commentsPerVideo} comment tá»« ${systemConfig.commentsPerVideo} CTV khÃ¡c nhau`),
                                    React.createElement('li', null, 'â€¢ Tick checkbox = Ä‘Ã¡nh dáº¥u CTV Ä‘Ã£ hoÃ n thÃ nh comment')
                                )
                            ),
                            
                            React.createElement('div', { className: "bg-indigo-50 p-3 sm:p-4 rounded-lg" },
                                React.createElement('h3', { className: "font-medium text-indigo-800 mb-2 text-sm sm:text-base" }, 'Thá»‘ng kÃª tá»•ng:'),
                                React.createElement('div', { className: "grid grid-cols-2 gap-4 text-xs sm:text-sm" },
                                    React.createElement('div', null,
                                        React.createElement('div', { className: "text-indigo-600" }, 'Tá»•ng video:'),
                                        React.createElement('div', { className: "font-bold text-indigo-800" }, `${systemConfig.totalCTV * systemConfig.videosPerCTV} video`),
                                        React.createElement('div', { className: "text-xs text-indigo-500" }, `(${systemConfig.totalCTV} CTV Ã— ${systemConfig.videosPerCTV} video)`)
                                    ),
                                    React.createElement('div', null,
                                        React.createElement('div', { className: "text-indigo-600" }, 'Tá»•ng comment:'),
                                        React.createElement('div', { className: "font-bold text-indigo-800" }, `${systemConfig.totalCTV * systemConfig.videosPerCTV * systemConfig.commentsPerVideo} comment`),
                                        React.createElement('div', { className: "text-xs text-indigo-500" }, `(${systemConfig.totalCTV * systemConfig.videosPerCTV} video Ã— ${systemConfig.commentsPerVideo} cmt)`)
                                    )
                                )
                            ),

                            React.createElement('div', { className: "bg-orange-50 p-3 sm:p-4 rounded-lg" },
                                React.createElement('p', { className: "text-xs sm:text-sm text-orange-800" },
                                    'ðŸ’¡ ',
                                    React.createElement('strong', null, 'CÃ¡ch sá»­ dá»¥ng:'),
                                    ' Chá»n CTV Ä‘á»ƒ xem chi tiáº¿t video vÃ  comment. Tick checkbox khi CTV hoÃ n thÃ nh. ÄÃ¡nh dáº¥u video bá»‹ xÃ³a vÃ  reply. Quáº£n lÃ½ lá»—i, cáº£nh cÃ¡o, áº£nh spam trá»±c tiáº¿p trong danh sÃ¡ch CTV!'
                                )
                            ),

                            React.createElement('div', { className: "bg-green-50 p-3 sm:p-4 rounded-lg" },
                                React.createElement('h3', { className: "font-medium text-green-800 mb-2 text-sm sm:text-base" }, 'âœ¨ TÃ­nh nÄƒng má»›i:'),
                                React.createElement('ul', { className: "text-xs sm:text-sm text-green-700 space-y-1" },
                                    React.createElement('li', null, 'â€¢ âŒ ÄÃ¡nh dáº¥u video bá»‹ xÃ³a'),
                                    React.createElement('li', null, 'â€¢ ðŸ”„ YÃªu cáº§u Ä‘Ã¡nh dáº¥u reply báº¯t buá»™c'),
                                    React.createElement('li', null, 'â€¢ â†•ï¸ Thay Ä‘á»•i thá»© tá»± CTV trong danh sÃ¡ch'),
                                    React.createElement('li', null, 'â€¢ âš™ï¸ CÃ i Ä‘áº·t sá»‘ CTV, comment/video, video/CTV'),
                                    React.createElement('li', null, 'â€¢ ðŸ“¸ Theo dÃµi áº£nh spam TikTok (15) vÃ  Telegram (5)'),
                                    React.createElement('li', null, 'â€¢ ðŸ’° Quáº£n lÃ½ lá»—i: pháº¡t 20k, ná»­a ngÃ y, 1 ngÃ y'),
                                    React.createElement('li', null, 'â€¢ âš ï¸ Há»‡ thá»‘ng cáº£nh cÃ¡o 4 cáº¥p Ä‘á»™'),
                                    React.createElement('li', null, 'â€¢ ðŸ’µ TÃ­nh lÆ°Æ¡ng tá»± Ä‘á»™ng (1tr1 - cÃ¡c khoáº£n pháº¡t)'),
                                    React.createElement('li', null, 'â€¢ ðŸ”„ Reset thÃ´ng minh (giá»¯ láº¡i lá»—i vÃ  cáº£nh cÃ¡o)'),
                                    React.createElement('li', null, 'â€¢ ðŸ“Š Tá»· lá»‡ hoÃ n thÃ nh dá»±a trÃªn tick checkbox')
                                )
                            ),

                            React.createElement('div', { className: "bg-blue-50 p-3 sm:p-4 rounded-lg" },
                                React.createElement('h3', { className: "font-medium text-blue-800 mb-2 text-sm sm:text-base" }, 'ðŸŽ¯ HÆ°á»›ng dáº«n sá»­ dá»¥ng:'),
                                React.createElement('ul', { className: "text-xs sm:text-sm text-blue-700 space-y-1" },
                                    React.createElement('li', null, '1. Chá»n CTV tá»« danh sÃ¡ch bÃªn trÃ¡i'),
                                    React.createElement('li', null, '2. Xem chi tiáº¿t 3 video cá»§a CTV Ä‘Ã³'),
                                    React.createElement('li', null, '3. Tick âœ… khi CTV hoÃ n thÃ nh comment'),
                                    React.createElement('li', null, '4. ÄÃ¡nh dáº¥u âŒ náº¿u video bá»‹ xÃ³a'),
                                    React.createElement('li', null, '5. ÄÃ¡nh dáº¥u ðŸ”„ khi CTV Ä‘Ã£ reply'),
                                    React.createElement('li', null, '6. Quáº£n lÃ½ lá»—i vÃ  cáº£nh cÃ¡o trong danh sÃ¡ch CTV'),
                                    React.createElement('li', null, '7. Theo dÃµi áº£nh spam vÃ  lÆ°Æ¡ng tá»± Ä‘á»™ng'),
                                    React.createElement('li', null, '8. Xuáº¥t bÃ¡o cÃ¡o Excel khi cáº§n')
                                )
                            )
                        )
                    )
                )
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(CommentManager));
    </script>
</body>
</html>
